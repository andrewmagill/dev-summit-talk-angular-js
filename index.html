<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Mapping Applications with Angular JS</title>

		<meta name="description" content="Talk given at the 2014 Esri International Developers Summit about using Angular JS for rich mapping applications.">
		<meta name="author" content="Patrick Arlt">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/esri.css" id="theme">

		<link rel="stylesheet" href="plugin/leaflet/reveal-leaflet.css">
		<link rel="stylesheet" href="lib/leaflet-marker-cluster/MarkerCluster.css">
		<link rel="stylesheet" href="lib/leaflet-marker-cluster/MarkerCluster.Default.css">

		<link rel="stylesheet" href="lib/esri-leaflet-geocoder/esri-leaflet-geocoder.css">

		<link rel="stylesheet" href="lib/esri-leaflet-demographics/esri-leaflet-legend.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/solarized.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div class="slides">

				<section class="left">
					<h1>Mapping Apps w/ Angular JS</h1>
					<h3>Patrick Arlt</h3>
					<p>Experiance Developer - Esri Portland R&D Center</p>
					<p><a href="http://twitter.com/patrickarlt">@patrickarlt</a> - <a href="http://patrickarlt.github.io/dev-summit-talk-angular-js/">http://patrickarlt.github.io/dev-summit-talk-angular-js/</a></p>
				</section>

				<section>
					<h1>Or How I Learned to Stop Worrying and Love Angular JS</h1>
				</section>

				<section>
					<h2>The Internet says Angular JS is amazing!</h2>
				</section>

				<section>
					<div class="block-group block-group-2-up">
						<div class="block" style="text-align:center;">
							<br>
							<img src="diagram1.png" alt="">
							<br>
						</div>
						<div class="block" style="text-align:center;">
							<br>
							<img src="diagram2.png" alt="">
							<br>
						</div>
						<div class="block" style="text-align:center;">
							<br>
							<img src="diagram3.png" alt="">
							<br>
						</div>
						<div class="block" style="text-align:center;">
							<br>
							<img src="diagram4.png" alt="">
							<br>
						</div>
					</div>
				</section>

				<section class="left">
					<div style="vertical-align:middle;">
						<img src="terminology.jpg" alt="" class="float:left;" width="800">
						<ul style="float: right; margin-top: 1.5em; margin-right: 2em;">
							<li>directives?</li>
							<li>transclusion?</li>
							<li>HTML compilation?</li>
							<li>providers?</li>
							<li>injectors?</li>
							<li>disgest cycle?</li>
							<li>indigestion?</li>
						</ul>
					</div>
				</section>

				<section>
					<img src="junk.jpg" alt="what a peice of junk">
				</section>

				<section class="left">
					<h1>Web Components</h1>
					<br>
					<h3>Extend the vocabulary of HTML</h3>
					<br>
					<ul>
						<li>Shadow DOM</li>
						<li>HTML Templates</li>
						<li>Custom Elements</li>
						<li>HTML Imports</li>
					</ul>
					<p><a href="https://www.youtube.com/watch?v=fqULJBBEVQE#t=177">https://www.youtube.com/watch?v=fqULJBBEVQE#t=177</a></p>
				</section>

				<section>
					<pre><code class="xml">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;title&gt;Mind Blown&lt;/title&gt;
		&lt;link rel=&quot;import&quot; href=&quot;esri-maps.html&quot;&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;map id=&quot;map&quot;center=&quot;45.528, -122.680&quot; zoom=&quot;15&quot;&gt;
			&lt;featureLayer id=&quot;parks&quot; url=&quot;http://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/Parks_pdx/FeatureServer/0&quot; /&gt;
		&lt;/map&gt;

		&lt;script type=&quot;text/javascript&quot;&gt;
			var map = document.getElementById("map");

			map.on(&quot;click&quot;, function(e){
				console.log(&quot;map was clicked on&quot;);
			});

			var parks = document.getElementById("parks");

			parks.on(&quot;click&quot;, function(feature){
				console.log(&quot;you clicked on &quot; + feature.name);
			});
		&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>
				</section>

				<section class="left">
					<h1>So This Angular JS Thing...</h1>
					<p>Angular is the only production-ready way to do ANYTHING like Web Components</p>
					<p class="fragment">Angular also has a TON of features for building web apps</p>
				</section>

				<section>
					<h1>Angular JS Features</h1>
					<br>
					<ul class="block-group block-group-3-up">
						<li class="block">Data Binding</li>
						<li class="block">Controller</li>
						<li class="block">Plain JavaScript</li>
						<li class="block">Deep Linking</li>
						<li class="block">Form Validation</li>
						<li class="block">Server Communication</li>
						<li class="block">Directives</li>
						<li class="block">Reusable Components</li>
						<li class="block">Localization</li>
						<li class="block">Embeddable</li>
						<li class="block">Injectable</li>
						<li class="block">Testable</li>
					</ul>
				</section>

				<section>
					<h3>My First Angular App - Map Attack</h3>
					<img src="map-attack-realtime-geofencing.jpg" alt="Map Attack">
					<p>~275 lines of code</p>
				</section>

				<section>
					<h1>How Angular JS Works</h1>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - App</h3>
					</header>
					<p>Angular has its own system for scoping and namespaceing modules.</p>
					<pre><code class="javascript">var app = angular.module('todo', []);</code></pre>
					<pre><code class="html">&lt;div ng-app=&quot;todo&quot;&gt;
  ...
&lt;/div&gt;</code></pre>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Controllers and <code>$scope</code></h3>
					</header>
					<p><code>$scope</code> represents our "Model" and how we interact with our data</p>
					<p>Controllers bind our <code>$scope</code> to chunks of DOM</p>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Controllers and <code>$scope</code></h3>
					</header>
					<pre><code class="html"><div ng-app>
	<div ng-controller="MainCtrl">
		{{title}}
	</div>
</div></code></pre>
					<pre><code class="javascript">function MainCtrl($scope){
	$scope.title = "Hello World";
}</code></pre>
					<a href="http://jsfiddle.net/patrickarlt/qv2v5/">http://jsfiddle.net/patrickarlt/qv2v5/</a>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Controllers & <code>$scope</code></h3>
					</header>
					<ul>
						<li>Attach our data to <code>$scope</code></li>
						<li>Controller will bind <code>$scope</code> to DOM</li>
					</ul>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Expressions</h3>
					</header>
					<ul>
						<li>You have secretly been using expressions this whole time!</li>
						<li><code>{{ title }}</code> is an expression.</li>
						<li>So is <code>{{ "Angular Says " + title }}</code></li>
						<li>Expressions are ALWAYS evaluated against the current <code>$scope</code></li>
					</ul>
					<p></p>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Directives</h3>
					</header>
					<p>Directives tell Angular HOW to bind <code>$scope</code> to the DOM</p>
					<pre><code class="html"><div ng-app>
    <div ng-controller="MainCtrl">
        <h1 ng-class="{big: isBig}">{{title}}</h1>
    </div>
</div></code></pre>
<pre><code class="javascript">function MainCtrl($scope){
    $scope.isBig = true;
    $scope.title = "Hello World"
}</code></pre>

					<a href="http://jsfiddle.net/patrickarlt/5CRkr/1/">http://jsfiddle.net/patrickarlt/5CRkr/1/</a>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Data Binding</h3>
					</header>
					<p>Bind data from <code>$scope</code> to DOM and vica-versa</p>
					<pre><code class="html"><div ng-app>
    <div ng-controller="MainCtrl">
        <input type="text" ng-model="title" />
        <h1>{{title}}</h1>
    </div>
</div></code></pre>
<pre><code class="javascript">function MainCtrl($scope){
    $scope.title = "Hello World"
}</code></pre>
				<a href="http://jsfiddle.net/patrickarlt/w3ZU3/">http://jsfiddle.net/patrickarlt/w3ZU3/</a>
				</section>

				<section>
					<img src="magic.jpg" alt="">
					<h3>Is Magic</h3>
				</section>

				<section>
					<h1>How does Angular know the scope changed!</h1>
					<p class="fragment">You can't watch JavaScript objects for changes!</p>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Dirty Checking</h3>
					</header>
					<p class="fragment">Angular compares the new <code>$scope</code> the old <code>$scope</code></p>
					<p class="fragment">If <code>$scope</code> changed, directives will handle changing the DOM</p>
					<p class="fragment"><a href="http://stackoverflow.com/questions/9682092/databinding-in-angularjs">http://stackoverflow.com/questions/9682092/databinding-in-angularjs</a></p>
				</section>

				<section>
					<h1>How does Angular know when to do dirty checking?</h1>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - Digest Loop</h3>
					</header>
					<p>First lets break Angular&hellip;</p>
					<pre><code class="html">&lt;div ng-app&gt;
  &lt;div ng-controller=&quot;MainCtrl&quot;&gt;
    &lt;h1&gt;{{title}}&lt;/h1&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
					<pre><code class="javascript">function MainCtrl($scope){
  $scope.title = "Hello World"

  setTimeout(function(){
    $scope.title = "Angular is Magic!";
  }, 500);
}</code></pre>
					<a href="http://jsfiddle.net/patrickarlt/u5T9v/">http://jsfiddle.net/patrickarlt/u5T9v/</a>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - <code>$scope.$apply</code></h3>
					</header>
					<p>Tells Angular you are changing the <code>$scope</code>.</p>
					<pre><code class="html">&lt;div ng-app&gt;
  &lt;div ng-controller=&quot;MainCtrl&quot;&gt;
      &lt;h1&gt;{{title}}&lt;/h1&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
					<pre><code class="javascript">function MainCtrl($scope){
  $scope.title = "Hello World"

  setTimeout(function(){
    $scope.$apply(function(){
      $scope.title = "Angular is Magic!";
    });
  }, 500);
}</code></pre>
					<a href="http://jsfiddle.net/patrickarlt/JRvnH/">http://jsfiddle.net/patrickarlt/JRvnH/</a>
				</section>

				<section class="left">
					<header>
						<h3>How Angular Works - <code>$scope.$apply</code></h3>
					</header>
					<p>Most of the time you don't have to call <code>$scope.$apply</code>. Just use Angulars helpers, they wrap <code>$scope.$apply</code> for you.</p>
					<pre><code class="javascript">function MainCtrl($scope, $timeout){
    $scope.title = "Hello World"

    $timeout(function(){
        $scope.title = "Angular is Magic!";
    }, 500);
}</code></pre>
					<a href="http://jsfiddle.net/patrickarlt/MzjL6/1">http://jsfiddle.net/patrickarlt/MzjL6/</a>
				</section>

				<section>
						<h2>One last <code>$scope.$apply</code> example</h2>
						<pre><code class="javascript">var socket = io.connect('http://api.mapattack.org:8000');

socket.on('data', function(payload){
  $scope.$apply(function(){
		$scope.gameState = payload;
  });
});</code></pre>
					<p class="fragment">Think of <code>$scope.$apply</code> as APPLYING changes to your SCOPE</p>
				</section>

				<section>
					<h1>A Simple Angular App</h1>
					<p><a href="">http://jsfiddle.net/patrickarlt/LS2Vp/2/</a></p>
				</section>

				<section>
					<img src="not-impressed.png" alt="Not Impressed">
					<br>
					<br>
					<h2 class="fragment">I thought this was about maps...</h2>
				</section>

				<section>
					<h1>Fine.</h1>
					<h1>Lets Make <code>&lt;map&gt;</code>.</h1>
				</section>

				<section>
					<h1>But first we have to make Angular and Dojo play nice.</h1>
				</section>

				<section class="left">
					<div class="block-group block-group-3-up">
						<div class="block fragment">
							<h3>The Good</h3>
							<ul>
								<li>Angular has Modules</li>
								<li>Dojo has Modules</li>
								<li>They work well </li>
							</ul>
						</div>
						<div class="block fragment">
							<h3>The Bad</h3>
							<ul>
								<li>Angular wants to manages module initalization via dependency injection</li>
								<li>Dojo wants to manage module loading via AMD</li>
							</ul>
						</div>
						<div class="block fragment">
							<h3>The Ugly</h3>
							<ul>
								<li>No real documentation on doing this</li>
								<li>No good examples either</li>
							</ul>
						</div>
					</div>
					<br>
					<div class="fragment">
						<hr>
						<p class="center-text"><a href="https://github.com/patrickarlt/dev-summit-talk-angular-js/tree/gh-pages/examples/js-api-setup">Example Setup on GitHub</a></p>
						<p class="center-text"><a href="https://github.com/odoe/angular-esri">Alternate Example</a></p>
					</div>
				</section>

				<section class="left">
					<header>
						<h2>Directives - The Story So Far</h2>
					</header>
					<ul>
						<li class="fragment">Directive tell Controllers how to bind <code>$scope</code> to DOM</li>
						<li class="fragment">There are lots of built-in directives like <code>ng-repeat</code>, <code>ng-submit</code> and <code>ng-class</code></li>
						<li class="fragment">What if we could bind <code>$scope</code> to other things? Charts, maps ect...</li>
					</ul>
				</section>

				<section class="left">
					<header>
						<h2>Custom Directives - Resources</h2>
					</header>
					<ul>
						<li><a href="http://amitgharat.wordpress.com/2013/06/08/the-hitchhikers-guide-to-the-directive/">http://amitgharat.wordpress.com/2013/06/08/the-hitchhikers-guide-to-the-directive/</a></li>
						<li><a href="http://thecodebarbarian.wordpress.com/2013/09/23/the-8020-guide-to-writing-angularjs-directives/">http://thecodebarbarian.wordpress.com/2013/09/23/the-8020-guide-to-writing-angularjs-directives/</a></li>
						<li><a href="http://seanhess.github.io/2013/10/14/angularjs-directive-design.html">http://seanhess.github.io/2013/10/14/angularjs-directive-design.html</a></li>
						<li><a href="http://www.ng-newsletter.com/posts/directives.html">http://www.ng-newsletter.com/posts/directives.html</a></li>
						<li><a href="https://github.com/angular/angular.js/wiki/Understanding-Directives">https://github.com/angular/angular.js/wiki/Understanding-Directives</a></li>
						<li><a href="http://docs.angularjs.org/guide/directive">http://docs.angularjs.org/guide/directive</a></li>
					</ul>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Structure</h3>
					</header>
					<pre><code class="javascript">App.directive('features', function(){
  return {
    restrict: 'ECA',
    scope: true,
    controller: function($scope){
    },
    compile: function(element, attrs){
		},
    link: function(scope, element, attrs, controller){
    }
  };
});</code></pre>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Restrict</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Scope</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Controller</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Compile</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Link</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Handling Events</h3>
					</header>
				</section>

				<section class="left">
					<header>
						<h3>Custom Directives - Data Binding</h3>
					</header>
				</section>

				<section class="left">
					<pre><code class="javascript">App.directive('map', function(){
  return {
    restrict: 'E',
    controller: function($scope){
    },
    compile: function(element, attrs){
		},
    link: function(scope, element, attrs, controller){
    }
  };
});</code></pre>
				</section>

				<section>
					<h1>That Was Fun!</h1>
					<h1><code>&lt;featureLayer&gt;</code>?</h1>
				</section>

				<section class="left">
					<pre><code class="javascript">App.directive('features', function(){
  return {
    restrict: 'E',
    require: '^map',
    controller: function($scope){
    },
    compile: function(element, attrs){
		},
    link: function(scope, element, attrs, controller){
    }
  };
});</code></pre>
				</section>

				<section>
					<h1>Putting All Togather</h1>
				</section>

				<section class="left">
					<div style="vertical-align:middle;">
						<img src="i-know.jpg" alt="I Know Angular JS" width="825" style="margin: 3.5em 0 0 0;">
						<div style="float: right; margin-right: 2em;">
							<h3>Except For&hellip;</h3>
							<ul>
								<li>Testing</li>
								<li>Animations</li>
								<li>Routing</li>
								<li>Services</li>
								<li>Filters</li>
								<li>Dependency Injection</li>
								<li>And some other stuff...</li>
							</ul>
						</div>
					</div>
				</section>

				<section class="left">
					<h1>Thanks!</h1>
					<p>Twitter : <a href="http://twitter.com/patrickarlt">@patrickarlt</a></p>
					<p>Slides : <a href="http://patrickarlt.github.io/dev-summit-talk-angular-js/">http://patrickarlt.github.io/dev-summit-talk-angular-js/</a></p>
					<br>
					<div class="center-text">
						<img src="esri-logo.png" alt="Esri" width="280" height="118" >
					</div>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script src="plugin/leaflet/leaflet.js"></script>

		<script src="plugin/leaflet/reveal-leaflet.js"></script>

		<script src="lib/leaflet-marker-cluster/leaflet.markercluster.js"></script>

		<script src="lib/esri-leaflet/esri-leaflet.js"></script>
		<script src="lib/esri-leaflet/extras/clustered-feature-layer.js"></script>
		<script src="lib/esri-leaflet/extras/heatmap-feature-layer.js"></script>

		<script src="lib/esri-leaflet-geocoder/esri-leaflet-geocoder.js"></script>

		<script src="lib/esri-leaflet-demographics/esri-leaflet-demographics.js"></script>

		<script src="lib/leaflet-heat/leaflet-heat.js"></script>

		<script>
			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: false,

				width: 1366,
		    height: 768,

 				// Factor of the display size that should remain empty around the content
    		margin: 0.25,

    		// Bounds for smallest/largest possible scale to apply to content
		    minScale: 0.75,
		    maxScale: 1.0,

				theme: 'esri', // available themes are in /css/theme
				transition: 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: '/background.jpg',
				// parallaxBackgroundSize: '2193px 1334px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

			var map1 = L.map("map1").setView([51.505, -0.09], 13);
			var tiles = L.esri.basemapLayer("Topographic").addTo(map1);
		</script>

	</body>
</html>